CREATE TABLE StreamingServices
(SS_ID INT NOT NULL CHECK(SS_ID > 0), 
SSName VARCHAR(64) NOT NULL, 
HasAds BOOL NOT NULL,
PRIMARY KEY (SS_ID), 
UNIQUE(SSName));


CREATE TABLE Movies
(MV_ID INT NOT NULL CHECK(MV_ID > 0), 
MVName VARCHAR(64) NOT NULL,
MVReleaseYear YEAR NOT NULL CHECK(MVReleaseYear >= 1888),
MVSummary VARCHAR(250),
MVAgeRating VARCHAR(10) CHECK(MVAgeRating IN 
('G', 'PG', 'PG-13', 'R', 'NC-17')),
MVRuntime INT CHECK(MVRuntime > 0),
PRIMARY KEY (MV_ID));


CREATE TABLE StreamingServiceMovies
(SS_ID INT NOT NULL,
MV_ID INT NOT NULL,
MVViewCount INT NOT NULL CHECK(MVViewCount >= 0),
MVReviewScore DECIMAL(2, 1) 
CHECK(MVReviewScore >= 0 AND MVReviewScore <= 10),
MVAvailability BOOL NOT NULL,
PRIMARY KEY (SS_ID, MV_ID),
FOREIGN KEY (SS_ID) REFERENCES 
StreamingServices (SS_ID) 
ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY (MV_ID) REFERENCES Movies (MV_ID)
ON UPDATE CASCADE ON DELETE CASCADE);


CREATE TABLE Studios
(ST_ID INT NOT NULL CHECK(ST_ID > 0),
STName VARCHAR(64) NOT NULL,
CountryOfOrigin VARCHAR(3) NOT NULL,
PRIMARY KEY (ST_ID),
UNIQUE(STName));


CREATE TABLE MovieProducedBy
(MV_ID INT NOT NULL,
ST_ID INT NOT NULL,
PRIMARY KEY (MV_ID, ST_ID),
FOREIGN KEY (MV_ID) REFERENCES Movies (MV_ID) 
ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY (ST_ID) REFERENCES Studios (ST_ID)
ON UPDATE CASCADE ON DELETE CASCADE);


CREATE TABLE MovieGenres
(MV_ID INT NOT NULL,
MVGenre VARCHAR(64) NOT NULL,
PRIMARY KEY (MV_ID, MVGenre),
FOREIGN KEY (MV_ID) REFERENCES Movies (MV_ID)
ON UPDATE CASCADE ON DELETE CASCADE);


CREATE TABLE MovieAudioLanguageOptions
(MV_ID INT NOT NULL,
SS_ID INT NOT NULL,
MVLanguage VARCHAR(64) NOT NULL,
PRIMARY KEY (MV_ID, SS_ID, MVLanguage),
FOREIGN KEY (MV_ID) REFERENCES Movies (MV_ID)
ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY (SS_ID) REFERENCES StreamingServices (SS_ID)
ON UPDATE CASCADE ON DELETE CASCADE);






CREATE TABLE TVShows(
    TVS_ID INT NOT NULL CHECK(TVS_ID > 0),
    TVSName VARCHAR(64) NOT NULL,
    TVSReleaseYear YEAR NOT NULL CHECK(TVSReleaseYear >= 1888),
    TVSSummary VARCHAR(250),
    TVSAgeRating VARCHAR(10) CHECK(TVSAgeRating IN ('TV-Y', 'TV-Y7', 'TV-Y7 FV', 'TV-G', 'TV-PG', 'TV-14', 'TV-MA')),
    TVSUpdateStatus VARCHAR(64) CHECK (TVSUpdateStatus IN ('Ongoing', 'Finished', 'Cancelled')),
    PRIMARY KEY (TVS_ID)
);


CREATE TABLE StreamingServiceTVShows (
    SS_ID INT NOT NULL,
    TVS_ID INT NOT NULL,
    TVSViewCount INT NOT NULL CHECK (TVSViewCount >= 0),
    TVSReviewScore DECIMAL(2,1) CHECK (TVSReviewScore >= 0 AND TVSReviewScore <= 10),
    TVSAvailability BOOL NOT NULL,
    PRIMARY KEY (SS_ID, TVS_ID),
    FOREIGN KEY (SS_ID) REFERENCES StreamingServices(SS_ID) ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (TVS_ID) REFERENCES TVShows(TVS_ID) ON UPDATE CASCADE ON DELETE CASCADE
);


CREATE TABLE Seasons (
    TVS_ID INT NOT NULL,
    SE_ID INT NOT NULL,
    Name VARCHAR(255),
    ReleaseYear YEAR,
    PRIMARY KEY (TVS_ID, SE_ID),
    FOREIGN KEY (TVS_ID) REFERENCES TVShows(TVS_ID) ON UPDATE CASCADE ON DELETE CASCADE
);


CREATE TABLE Episodes (
    TVS_ID INT NOT NULL,
    SE_ID INT NOT NULL,
    EP_ID INT NOT NULL,
    Name VARCHAR(255),
    ReleaseYear YEAR CHECK (ReleaseYear >= 1900),
    Summary TEXT,
    Runtime INT CHECK (Runtime >= 0),
    PRIMARY KEY (TVS_ID, SE_ID, EP_ID),
    FOREIGN KEY (TVS_ID, SE_ID) REFERENCES Seasons(TVS_ID, SE_ID) ON UPDATE CASCADE ON DELETE CASCADE
);


CREATE TABLE TVShowProducedBy (
    TVS_ID INT NOT NULL,
    ST_ID INT NOT NULL,
    PRIMARY KEY (TVS_ID, ST_ID),
    FOREIGN KEY (TVS_ID) REFERENCES TVShows(TVS_ID) ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (ST_ID) REFERENCES Studios(ST_ID) ON UPDATE CASCADE ON DELETE CASCADE
);


CREATE TABLE TVShowGenres (
    TVS_ID INT NOT NULL,
    Genre VARCHAR(64) NOT NULL,
    PRIMARY KEY (TVS_ID, Genre),
    FOREIGN KEY (TVS_ID) REFERENCES TVShows(TVS_ID) ON UPDATE CASCADE ON DELETE CASCADE
);


CREATE TABLE TVShowAudioLanguageOptions (
    TVS_ID INT NOT NULL,
    SS_ID INT NOT NULL,
    Language VARCHAR(64) NOT NULL,
    PRIMARY KEY (TVS_ID, SS_ID, Language),
    FOREIGN KEY (TVS_ID) REFERENCES TVShows(TVS_ID) ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (SS_ID) REFERENCES StreamingServices(SS_ID) ON UPDATE CASCADE ON DELETE CASCADE
);